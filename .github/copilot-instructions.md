# GitHub Copilot - Instructions du Projet

## Vue d'ensemble du projet

Ce projet est une API .NET 9 qui g√®re des sessions de jeu entre amis. Il utilise ASP.NET Core avec des endpoints qui utilise la Minimal API comme architecture et Swagger ne doit pas √™tre utilis√© pour la documentation API : utilisation de Scalar.

## Guidelines pour l'utilisation de GitHub Copilot

### 1. Standards de code .NET

- **Conventions de nommage** : Suivez les conventions C# standard (PascalCase pour les classes et m√©thodes, camelCase pour les variables locales)
- **Documentation XML** : Ajoutez des commentaires XML pour toutes les m√©thodes publiques
- **Async/await** : Utilisez les patterns asynchrones pour les op√©rations I/O
- **Injection de d√©pendances** : Respectez le pattern DI d'ASP.NET Core

### 2. Architecture du projet

**R√àGLE ESSENTIELLE : Architecture en couches avec projets s√©par√©s**

- **Projet API** (`TestWithCopilotVS`) : Contient uniquement les endpoints, la configuration et Program.cs
- **Projet Models** (`TestWithCopilotVS.Models`) : Contient toutes les entit√©s/mod√®les (ex: `Friend.cs`, `Statistique.cs`)
- **Projet Repositories** (`TestWithCopilotVS.Repositories`) : Contient tous les repositories et interfaces (ex: `IFriendRepository.cs`, `FriendRepository.cs`)
- **Projet Tests** (`TestWithCopilotVS.Tests`) : Contient tous les tests unitaires et BDD

**D√©tails par couche :**
- **Endpoints** : Utilisez les minimal APIs d'ASP.NET Core dans le projet principal
- **Mod√®les** : Une seule d√©finition par entit√©, dans le projet `.Models` uniquement
- **Repositories** : Pattern Repository avec interfaces dans le projet `.Repositories`
- **Extensions** : M√©thodes d'extension pour les services dans le projet principal (ex: `CustomCorsExtensions.cs`)

**R√©f√©rences entre projets :**
- API ‚Üí Models + Repositories
- Repositories ‚Üí Models  
- Tests ‚Üí Models + Repositories (+ API si n√©cessaire pour les tests d'int√©gration)

### 3. Bonnes pratiques avec Copilot

- **Validation** : Toujours valider les suggestions de Copilot avant de les accepter, attendre un GOO pour accepter
- **Tests** : Demandez √† Copilot de g√©n√©rer des tests unitaires pour le nouveau code, en mode TDD
- **Architecture** : Respectez IMP√âRATIVEMENT la s√©paration en couches - ne jamais dupliquer les mod√®les
- **S√©curit√©** : V√©rifiez que les suggestions respectent les bonnes pratiques de s√©curit√©
- **Performance** : Optimisez les requ√™tes et utilisez les bonnes pratiques .NET

**R√®gles strictes d'architecture :**
- ‚ùå **INTERDIT** : Dupliquer des classes/mod√®les dans plusieurs projets
- ‚ùå **INTERDIT** : Mettre des repositories dans le projet API principal
- ‚úÖ **OBLIGATOIRE** : Une seule source de v√©rit√© par entit√© dans `.Models`
- ‚úÖ **OBLIGATOIRE** : Tous les repositories dans `.Repositories`
- ‚úÖ **OBLIGATOIRE** : Respecter les d√©pendances entre couches

### 4. Prompts efficaces

Exemples de prompts √† utiliser avec Copilot Chat :

```
// Pour cr√©er un endpoint (dans le projet API)
"Cr√©e un endpoint GET pour r√©cup√©rer tous les amis avec pagination"

// Pour cr√©er un mod√®le (dans le projet .Models)
"Cr√©e une nouvelle entit√© Product dans le projet TestWithCopilotVS.Models"

// Pour cr√©er un repository (dans le projet .Repositories)
"Cr√©e IProductRepository et ProductRepository dans le projet TestWithCopilotVS.Repositories"

// Pour ajouter de la validation
"Ajoute la validation des donn√©es d'entr√©e avec des annotations dans le mod√®le"

// Pour les tests
"G√©n√®re des tests unitaires pour la classe ProductRepository dans le projet .Tests"

// Pour la documentation
"Ajoute des commentaires XML pour cette m√©thode"
```

**Prompts pour respecter l'architecture :**
```
// V√©rification avant cr√©ation
"V√©rifie que cette classe n'existe pas d√©j√† dans un autre projet"

// Migration de code mal plac√©
"D√©place cette classe vers le bon projet selon l'architecture en couches"
```


### 5. Processus complet de d√©veloppement d'une feature

**Workflow GitHub Issues ‚Üí Branche ‚Üí Code ‚Üí Tests ‚Üí Pull Request**

#### √âtape 1 : Cr√©ation de l'issue GitHub
1. **Demander √† l'utilisateur** :
   - L'intitul√© de la feature (titre clair et descriptif)
   - La description d√©taill√©e de la fonctionnalit√© souhait√©e
   
2. **Cr√©er l'issue** avec :
   - Titre : `[FEATURE] {intitul√© de la feature}`
   - Description compl√®te des besoins fonctionnels
   - Labels appropri√©s (`enhancement`, `feature`)
   - Assignation si n√©cessaire

#### √âtape 2 : Cr√©ation de la branche d√©di√©e
```bash
# Cr√©er et basculer sur une nouvelle branche
git checkout -b feat/issue-{num√©ro-issue}-{nom-feature-court}
```

**Convention de nommage des branches :**
- `feat/issue-{num√©ro}-{description-courte}`
- Exemple : `feat/issue-42-user-authentication`

#### √âtape 3 : D√©veloppement de la fonctionnalit√©
**Ordre de d√©veloppement obligatoire :**

1. **Mod√®les** (dans `TestWithCopilotVS.Models`) :
   - Cr√©er/modifier les entit√©s n√©cessaires
   - Ajouter les annotations de validation

2. **Interfaces Repository** (dans `TestWithCopilotVS.Repositories/Interfaces`) :
   - D√©finir les contrats des repositories

3. **Impl√©mentations Repository** (dans `TestWithCopilotVS.Repositories`) :
   - Impl√©menter les repositories avec la logique m√©tier

4. **Endpoints** (dans `TestWithCopilotVS`) :
   - Cr√©er les endpoints Minimal API
   - Configurer l'injection de d√©pendances

5. **Extensions** (si n√©cessaire) :
   - Ajouter les extensions de services

#### √âtape 4 : Tests unitaires (mode TDD)
**Impl√©mentation obligatoire des tests dans `TestWithCopilotVS.Tests` :**

1. **Tests des mod√®les** :
   - Validation des propri√©t√©s
   - Tests des annotations

2. **Tests des repositories** :
   - Tests unitaires complets
   - Mocking des d√©pendances

3. **Tests des endpoints** :
   - Tests d'int√©gration
   - Tests des codes de retour HTTP

4. **Tests BDD** (si applicable) :
   - Sc√©narios SpecFlow dans `Features/`
   - Step definitions dans `StepDefinitions/`

#### √âtape 5 : Commits et Push
**Structure des commits :**
```bash
# Commit initial du mod√®le
git add .
git commit -m "feat(models): add {EntityName} model for issue #{num√©ro}"

# Commit des repositories
git commit -m "feat(repositories): implement {EntityName}Repository for issue #{num√©ro}"

# Commit des endpoints
git commit -m "feat(api): add {feature} endpoints for issue #{num√©ro}"

# Commit des tests
git commit -m "test: add unit tests for {feature} - issue #{num√©ro}"

# Push vers GitHub
git push origin feat/issue-{num√©ro}-{nom-feature-court}
```

#### √âtape 6 : Cr√©ation de la Pull Request
**√âl√©ments obligatoires de la PR :**

1. **Titre** : `[FEATURE] {Titre de la feature} - Close #{num√©ro-issue}`

2. **Description** :
   ```markdown
   ## üöÄ Feature Description
   [Description de la fonctionnalit√©]
   
   ## üìã Changes Made
   - [ ] Mod√®les ajout√©s/modifi√©s
   - [ ] Repositories impl√©ment√©s  
   - [ ] Endpoints cr√©√©s
   - [ ] Tests unitaires ajout√©s
   - [ ] Documentation mise √† jour
   
   ## üîó Related Issue
   Closes #{num√©ro-issue}
   
   ## üß™ Testing
   - [ ] Tests unitaires passent
   - [ ] Tests d'int√©gration passent
   - [ ] Tests manuels effectu√©s
   
   ## üì∏ Screenshots (si applicable)
   [Screenshots de l'API ou des r√©sultats]
   ```

3. **Configuration** :
   - Lier √† l'issue avec `Closes #{num√©ro-issue}`
   - Assigner des reviewers
   - Ajouter des labels appropri√©s
   - Demander une review avant merge

**R√®gles de merge :**
- ‚úÖ Tous les tests doivent passer
- ‚úÖ Code review approuv√©
- ‚úÖ Pas de conflits avec `main`
- ‚úÖ Architecture respect√©e (couches s√©par√©es)

### 6. Gestion des branches et structure des commits

- **Avant chaque nouvelle feature**, suivez le processus complet d√©crit ci-dessus
- Utilisez des messages de commit clairs en utilisant le conventional commit messages (Conventional Commits) :
	- `chore:` pour les t√¢ches de maintenance et de construction d'architecture globale
	- `feat:` pour les nouvelles fonctionnalit√©s
	- `fix:` pour les corrections de bugs
	- `docs:` pour la documentation
	- `refactor:` pour le refactoring
	- `test:` pour les tests

### 7. R√©vision du code

- **Toujours r√©viser** le code g√©n√©r√© par Copilot
- **Tester** les fonctionnalit√©s avant de commiter
- **Documenter** les choix d'impl√©mentation non √©vidents
- **Optimiser** si n√©cessaire

## Ressources du projet

- **Framework** : .NET 9 / ASP.NET Core
- **Documentation API** : Scalar (pas Swagger)
- **Architecture** : Clean Architecture avec couches s√©par√©es
- **Pattern** : Repository pattern, Minimal APIs
- **Configuration** : appsettings.json pour les environnements

## Structure des projets

```
TestWithCopilotVS/                          # üöÄ Projet API principal
‚îú‚îÄ‚îÄ Program.cs                              # Point d'entr√©e et configuration
‚îú‚îÄ‚îÄ Endpoints/                              # Endpoints group√©s par fonctionnalit√©
‚îú‚îÄ‚îÄ Extensions/                             # Extensions de services
‚îî‚îÄ‚îÄ appsettings.json                        # Configuration

TestWithCopilotVS.Models/                   # üìã Mod√®les/Entit√©s
‚îú‚îÄ‚îÄ Friend.cs                               # ‚úÖ Seule d√©finition de Friend
‚îú‚îÄ‚îÄ Statistique.cs                          # ‚úÖ Seule d√©finition de Statistique
‚îî‚îÄ‚îÄ [Autres entit√©s...]

TestWithCopilotVS.Repositories/             # üóÉÔ∏è Couche d'acc√®s aux donn√©es
‚îú‚îÄ‚îÄ Interfaces/                             # Interfaces des repositories
‚îÇ   ‚îú‚îÄ‚îÄ IFriendRepository.cs
‚îÇ   ‚îî‚îÄ‚îÄ IStatistiqueRepository.cs
‚îú‚îÄ‚îÄ FriendRepository.cs                     # Impl√©mentations
‚îú‚îÄ‚îÄ StatistiqueRepository.cs
‚îî‚îÄ‚îÄ [Autres repositories...]

TestWithCopilotVS.Tests/                    # üß™ Tous les tests
‚îú‚îÄ‚îÄ UnitTests/                              # Tests unitaires
‚îú‚îÄ‚îÄ BddTests/                               # Tests BDD/SpecFlow
‚îÇ   ‚îú‚îÄ‚îÄ Features/
‚îÇ   ‚îî‚îÄ‚îÄ StepDefinitions/
‚îî‚îÄ‚îÄ IntegrationTests/                       # Tests d'int√©gration
```

---

*Derni√®re mise √† jour : Septembre 2025*
